task:
  name: Linux x86_64 (Intel)
  compute_engine_instance:
    image_project: ubuntu-os-cloud
    image: family/ubuntu-2204-lts
    platform: linux
    machine_type: n2-standard-2
    disk: 20

  env:
    RENV_CONFIG_ACTIVE: "FALSE"
    GITHUB_PAT: $CIRRUS_REPO_CLONE_TOKEN

  cpu_info_script: grep -m1 "model name" /proc/cpuinfo

  install_system_script: |
    apt-get update -qq
    apt-get install -y r-base python3-venv python3-dev python3-pip

  install_r_packages_script: |
    Rscript -e "
      install.packages('remotes', repos='https://cloud.r-project.org')
      remotes::install_github('keneo/play-zvec/rzvec')
      remotes::install_github('keneo/play-zvec/rszvec')
    "

  test_script: Rscript docker/ci-test.R
